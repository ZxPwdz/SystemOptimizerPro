<UserControl x:Class="SystemOptimizerPro.Views.CleaningToolsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="800">

    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled"
                  Padding="24">
        <StackPanel>
            <!-- Header -->
            <TextBlock Text="Cleaning Tools"
                       Style="{StaticResource HeadingStyle}"
                       Margin="0,0,0,24"/>

            <!-- DNS Cache -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,24">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="&#xE774;" FontFamily="Segoe MDL2 Assets" FontSize="20"
                                       Foreground="{StaticResource AccentPrimaryBrush}"
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="DNS Cache"
                                       Style="{StaticResource SubheadingStyle}"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Text="Flush the DNS resolver cache to fix network issues or clear old DNS entries."
                                   Style="{StaticResource BodyStyle}"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,12"/>

                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Entries: " Style="{StaticResource CaptionStyle}"/>
                            <TextBlock Text="{Binding DnsCacheEntries}"
                                       Style="{StaticResource CaptionStyle}"
                                       FontWeight="SemiBold"/>
                        </StackPanel>

                        <TextBlock Text="{Binding DnsStatus}"
                                   Style="{StaticResource CaptionStyle}"
                                   Margin="0,4,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <Button Style="{StaticResource PrimaryActionButton}"
                                Command="{Binding FlushDnsCacheCommand}"
                                IsEnabled="{Binding IsDnsLoading, Converter={StaticResource InverseBoolConverter}}"
                                Margin="0,0,0,8">
                            <TextBlock Text="Flush DNS"/>
                        </Button>

                        <Button Style="{StaticResource SecondaryButton}"
                                Command="{Binding RefreshDnsCacheCommand}"
                                IsEnabled="{Binding IsDnsLoading, Converter={StaticResource InverseBoolConverter}}">
                            <TextBlock Text="Refresh"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Recent Files -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,24">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="&#xE8A5;" FontFamily="Segoe MDL2 Assets" FontSize="20"
                                       Foreground="{StaticResource AccentPrimaryBrush}"
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Recent Files"
                                       Style="{StaticResource SubheadingStyle}"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Text="Clear Windows recent file history for privacy. This includes recent documents, jump lists, and recently used files."
                                   Style="{StaticResource BodyStyle}"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,12"/>

                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Files: " Style="{StaticResource CaptionStyle}"/>
                            <TextBlock Text="{Binding RecentFilesCount}"
                                       Style="{StaticResource CaptionStyle}"
                                       FontWeight="SemiBold"/>
                            <TextBlock Text=" | " Style="{StaticResource CaptionStyle}"/>
                            <TextBlock Text="{Binding RecentFilesSize}"
                                       Style="{StaticResource CaptionStyle}"
                                       FontWeight="SemiBold"/>
                        </StackPanel>

                        <TextBlock Text="{Binding RecentFilesStatus}"
                                   Style="{StaticResource CaptionStyle}"
                                   Margin="0,4,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <Button Style="{StaticResource PrimaryActionButton}"
                                Command="{Binding ClearRecentFilesCommand}"
                                IsEnabled="{Binding IsRecentFilesLoading, Converter={StaticResource InverseBoolConverter}}"
                                Margin="0,0,0,8">
                            <TextBlock Text="Clear Files"/>
                        </Button>

                        <Button Style="{StaticResource SecondaryButton}"
                                Command="{Binding RefreshRecentFilesCommand}"
                                IsEnabled="{Binding IsRecentFilesLoading, Converter={StaticResource InverseBoolConverter}}">
                            <TextBlock Text="Refresh"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Registry Cleaner -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="&#xE90F;" FontFamily="Segoe MDL2 Assets" FontSize="20"
                                   Foreground="{StaticResource AccentPrimaryBrush}"
                                   VerticalAlignment="Center" Margin="0,0,12,0"/>
                        <TextBlock Text="Registry Cleaner"
                                   Style="{StaticResource SubheadingStyle}"
                                   VerticalAlignment="Center"/>
                    </StackPanel>

                    <TextBlock Text="Scan for invalid registry entries including broken file associations, obsolete software references, and MRU lists. A backup is created before any changes."
                               Style="{StaticResource BodyStyle}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16"/>

                    <!-- Scan Progress -->
                    <ProgressBar Value="{Binding RegistryScanProgress}"
                                 Height="4"
                                 Margin="0,0,0,12"
                                 Visibility="{Binding IsRegistryScanning, Converter={StaticResource BoolToVisibilityConverter}}"/>

                    <!-- Action Buttons -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <Button Style="{StaticResource PrimaryActionButton}"
                                Command="{Binding ScanRegistryCommand}"
                                IsEnabled="{Binding IsRegistryScanning, Converter={StaticResource InverseBoolConverter}}"
                                Margin="0,0,12,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE721;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,8,0"/>
                                <TextBlock Text="Scan Registry"/>
                            </StackPanel>
                        </Button>

                        <Button Style="{StaticResource SecondaryButton}"
                                Command="{Binding CleanRegistryCommand}"
                                IsEnabled="{Binding IsRegistryScanning, Converter={StaticResource InverseBoolConverter}}"
                                Margin="0,0,12,0">
                            <TextBlock Text="Fix Selected"/>
                        </Button>

                        <Button Style="{StaticResource SecondaryButton}"
                                Command="{Binding RestoreBackupCommand}"
                                IsEnabled="{Binding IsRegistryScanning, Converter={StaticResource InverseBoolConverter}}">
                            <TextBlock Text="Restore Backup"/>
                        </Button>
                    </StackPanel>

                    <!-- Status -->
                    <TextBlock Text="{Binding RegistryStatus}"
                               Style="{StaticResource CaptionStyle}"
                               Margin="0,0,0,16"/>

                    <!-- Issues List -->
                    <Grid Visibility="{Binding RegistryIssueCount, Converter={StaticResource BoolToVisibilityConverter}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <CheckBox Grid.Row="0"
                                  Content="Select All"
                                  IsChecked="{Binding SelectAllIssues}"
                                  Margin="0,0,0,8"/>

                        <Border Grid.Row="1"
                                BorderBrush="{StaticResource BorderLightBrush}"
                                BorderThickness="1"
                                CornerRadius="8"
                                MaxHeight="200">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <ItemsControl ItemsSource="{Binding RegistryIssues}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Padding="12,8"
                                                    BorderBrush="{StaticResource BorderLightBrush}"
                                                    BorderThickness="0,0,0,1">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <CheckBox Grid.Column="0"
                                                              IsChecked="{Binding IsSelected}"
                                                              VerticalAlignment="Center"
                                                              Margin="0,0,12,0"/>

                                                    <StackPanel Grid.Column="1">
                                                        <TextBlock Text="{Binding CategoryDisplayName}"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                                                        <TextBlock Text="{Binding Description}"
                                                                   Style="{StaticResource CaptionStyle}"
                                                                   TextTrimming="CharacterEllipsis"/>
                                                    </StackPanel>

                                                    <Border Grid.Column="2"
                                                            Background="{StaticResource BackgroundTertiaryBrush}"
                                                            CornerRadius="4"
                                                            Padding="8,4"
                                                            VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding SeverityDisplayName}"
                                                                   Style="{StaticResource CaptionStyle}"/>
                                                    </Border>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Border>
                    </Grid>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
